# API системы выдачи кредитов

Система выдачи кредитов предоставляет REST API для управления клиентами и кредитами. Все эндпоинты API возвращают данные в формате JSON и используют соответствующие HTTP-коды состояния.

## Базовый URL

```
http://localhost:8080/api
```

## Коды состояния HTTP

API использует следующие коды состояния HTTP:

- `200 OK` - Запрос успешно обработан
- `201 Created` - Ресурс успешно создан
- `404 Not Found` - Запрашиваемый ресурс не найден
- `422 Unprocessable Entity` - Ошибка валидации данных
- `500 Internal Server Error` - Внутренняя ошибка сервера

## Формат ответа при ошибке

В случае ошибки API возвращает JSON-объект с описанием ошибки:

```json
{
  "error": "Описание ошибки",
  "details": {
    "field1": "Ошибка для поля 1",
    "field2": "Ошибка для поля 2"
  }
}
```

## API клиентов

### Получение списка клиентов

```http
GET /clients
```

#### Пример ответа

```json
[
  {
    "name": "Petr Pavel",
    "age": 35,
    "region": "PR",
    "city": "Prague",
    "income": 1500,
    "score": 600,
    "pin": "123-45-6789",
    "email": "petr.pavel@example.com",
    "phone": "+420123456789"
  },
  {
    "name": "Jana Novakova",
    "age": 42,
    "region": "BR",
    "city": "Brno",
    "income": 2000,
    "score": 700,
    "pin": "234-56-7890",
    "email": "jana.novakova@example.com",
    "phone": "+420234567890"
  }
]
```

### Получение информации о клиенте по PIN

```http
GET /clients/{pin}
```

#### Параметры пути

| Параметр | Описание            |
|----------|---------------------|
| pin      | PIN-код клиента     |

#### Пример ответа

```json
{
  "name": "Petr Pavel",
  "age": 35,
  "region": "PR",
  "city": "Prague",
  "income": 1500,
  "score": 600,
  "pin": "123-45-6789",
  "email": "petr.pavel@example.com",
  "phone": "+420123456789"
}
```

### Создание нового клиента

```http
POST /clients
Content-Type: application/json
```

#### Тело запроса

```json
{
  "name": "Test Client",
  "age": 30,
  "region": "PR",
  "city": "Prague",
  "income": 2000,
  "score": 700,
  "pin": "TEST-12345",
  "email": "test@example.com",
  "phone": "+42012345678"
}
```

#### Параметры запроса

| Параметр | Тип    | Описание                                          |
|----------|--------|---------------------------------------------------|
| name     | string | ФИО клиента                                       |
| age      | int    | Возраст клиента (от 18 до 100)                    |
| region   | string | Регион проживания (PR, BR, OS)                    |
| city     | string | Город проживания                                  |
| income   | int    | Ежемесячный доход                                |
| score    | int    | Кредитный рейтинг                                |
| pin      | string | Персональный идентификационный номер (уникальный) |
| email    | string | Электронная почта                                |
| phone    | string | Телефон                                          |

#### Пример ответа

```json
{
  "success": true,
  "client": {
    "name": "Test Client",
    "pin": "TEST-12345"
  }
}
```

## API кредитов

### Получение списка кредитов

```http
GET /credits
```

#### Пример ответа

```json
[
  {
    "name": "Mortgage Loan",
    "amount": 120000,
    "rate": "3.5%",
    "start_date": "2023-01-01",
    "end_date": "2043-01-01",
    "client": {
      "name": "Petr Pavel",
      "pin": "123-45-6789"
    }
  },
  {
    "name": "Consumer Loan",
    "amount": 5000,
    "rate": "9.9%",
    "start_date": "2023-06-01",
    "end_date": "2026-06-01",
    "client": {
      "name": "Jana Novakova",
      "pin": "234-56-7890"
    }
  }
]
```

### Создание нового кредита

```http
POST /credits
Content-Type: application/json
```

#### Тело запроса

```json
{
  "name": "Test Loan",
  "amount": 5000,
  "rate": 10.4,
  "startDate": "2024-01-01",
  "endDate": "2024-12-31"
}
```

#### Параметры запроса

| Параметр  | Тип     | Описание                       |
|-----------|---------|--------------------------------|
| name      | string  | Название кредита               |
| amount    | float   | Сумма кредита                  |
| rate      | float   | Процентная ставка (без знака %) |
| startDate | string  | Дата начала (формат YYYY-MM-DD) |
| endDate   | string  | Дата окончания (формат YYYY-MM-DD) |

#### Пример ответа

```json
{
  "success": true,
  "credit": {
    "name": "Test Loan",
    "amount": 5000,
    "rate": "10.4%"
  }
}
```

### Проверка возможности выдачи кредита

```http
POST /credits/check-approval/{pin}
Content-Type: application/json
```

#### Параметры пути

| Параметр | Описание            |
|----------|---------------------|
| pin      | PIN-код клиента     |

#### Тело запроса

```json
{
  "name": "Test Loan",
  "amount": 5000,
  "rate": 10.4,
  "startDate": "2024-01-01",
  "endDate": "2024-12-31"
}
```

#### Пример ответа (кредит одобрен)

```json
{
  "approved": true,
  "client": {
    "name": "Test Client",
    "pin": "TEST-12345"
  },
  "credit": {
    "name": "Test Loan",
    "amount": 5000,
    "rate": "10.4%"
  }
}
```

#### Пример ответа (кредит отклонен)

```json
{
  "approved": false,
  "reasons": ["Недостаточный кредитный рейтинг", "Недостаточный доход"],
  "client": {
    "name": "Eva Kralova",
    "pin": "LOW-SCORE"
  },
  "credit": {
    "name": "Test Loan",
    "amount": 5000,
    "rate": ""
  }
}
```

### Выдача кредита

```http
POST /credits/issue/{pin}
Content-Type: application/json
```

#### Параметры пути

| Параметр | Описание            |
|----------|---------------------|
| pin      | PIN-код клиента     |

#### Тело запроса

```json
{
  "name": "Test Loan",
  "amount": 5000,
  "rate": 10.4,
  "startDate": "2024-01-01",
  "endDate": "2024-12-31"
}
```

#### Пример ответа (кредит выдан)

```json
{
  "success": true,
  "approved": true,
  "credit": {
    "name": "Test Loan",
    "amount": 5000,
    "rate": "10.4%",
    "start_date": "2024-01-01",
    "end_date": "2024-12-31"
  },
  "client": {
    "name": "Test Client",
    "pin": "TEST-12345"
  }
}
```

#### Пример ответа (отказ в выдаче кредита)

```json
{
  "approved": false,
  "reasons": ["Недостаточный кредитный рейтинг"]
}
```

## Тестовые клиенты

Для тестирования API можно использовать предварительно созданных клиентов:

| PIN          | Описание                               |
|--------------|----------------------------------------|
| 123-45-6789  | Клиент из Праги с хорошим рейтингом    |
| 234-56-7890  | Клиент из Брно с хорошим рейтингом     |
| 345-67-8901  | Клиент из Остравы с средним рейтингом  |
| 456-78-9012  | Клиент из Праги с низким доходом       |
| LOW-SCORE    | Клиент с низким кредитным рейтингом    |
| TEST-12345   | Тестовый клиент для API-тестов         |

## Правила одобрения кредита

Кредит одобряется при соблюдении следующих условий:
1. Кредитный рейтинг клиента (Score) > 500
2. Доход клиента ≥ $1000/мес
3. Возраст клиента от 18 до 60 лет
4. Кредит выдается только клиентам из регионов Прага (PR), Брно (BR), Острава (OS)
5. Клиентам из Праги может быть случайно отказано в кредите
6. Клиентам из Остравы увеличивается процентная ставка на 5% 